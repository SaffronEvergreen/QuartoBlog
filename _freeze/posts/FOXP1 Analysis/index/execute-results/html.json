{
  "hash": "c7d557a16efb185b342dfb297b824bc3",
  "result": {
    "markdown": "---\ntitle: \"FOXP1 Analysis\"\nauthor: \"Saffron\"\ndate: \"2023-07-27\"\ncategories: [analysis, code, visualizations]\n---\n\n\nJust messing around with interactive plots.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\np_load(readr, tidyr, magrittr, knitr, tidyverse, janitor, broom, ggplot2, forcats, epitools, dplyr, xfun, plotly)\n```\n:::\n\n\nThe data used for this tinkering is found on the National Library of Medicine [ClinVar database](https://www.ncbi.nlm.nih.gov/clinvar/?term=FOXP1%5Bgene%5D&redir=gene).   \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load data\n# imported from directory\n# Helpful note to self: when loading csv files from \"copy path\" delete 'C:' and change all \\ to /\nCVFP1 <- read_csv(\"/Users/mckjo/OneDrive/Desktop/GitBlog/posts/FOXP1 Analysis/ShinyClinVar.csv\")\n\n# clean variable names\njanitor::clean_names(CVFP1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 144 × 14\n      x1 link         gene_symbol type  consequence clinical_significance review\n   <dbl> <chr>        <chr>       <chr> <chr>       <chr>                 <chr> \n 1     1 \"<a href=\\\"… FOXP1       SNV   Stop gain   Pathogenic            Crite…\n 2     2 \"<a href=\\\"… FOXP1       SNV   Missense    Benign/Likely benign  Crite…\n 3     3 \"<a href=\\\"… FOXP1       SNV   Intronic    Benign                Crite…\n 4     5 \"<a href=\\\"… FOXP1       SNV   Intronic    Benign                Crite…\n 5     6 \"<a href=\\\"… FOXP1       SNV   Missense    Likely benign         Crite…\n 6     7 \"<a href=\\\"… FOXP1       SNV   Intronic    Benign                Crite…\n 7     8 \"<a href=\\\"… FOXP1       SNV   Missense    Benign/Likely benign  Crite…\n 8    11 \"<a href=\\\"… FOXP1       SNV   Missense    Pathogenic            No as…\n 9    12 \"<a href=\\\"… FOXP1       SNV   Missense    Likely benign         Crite…\n10    13 \"<a href=\\\"… FOXP1       SNV   Synonymous  Uncertain/conflicting Crite…\n# ℹ 134 more rows\n# ℹ 7 more variables: phenotype_list <chr>, name <chr>, ref_aa <chr>,\n#   alt_aa <chr>, pos_aa <dbl>, cadd_phred <chr>, gnom_ad_binary_char <chr>\n```\n:::\n\n```{.r .cell-code}\n# number of rows (144)\nnrow(CVFP1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 144\n```\n:::\n\n```{.r .cell-code}\n# convert character variables to factors\nCVFP1 <- CVFP1 %>%\n  mutate_if(is.character, as.factor)\n\n# summary of dataset \nsummary(CVFP1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      ...1       \n Min.   :  1.00  \n 1st Qu.: 91.75  \n Median :136.50  \n Mean   :130.18  \n 3rd Qu.:186.25  \n Max.   :243.00  \n                 \n                                                                                           Link    \n <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/1013484\" target=\"_blank\">1013484</a>:  1  \n <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/1018781\" target=\"_blank\">1018781</a>:  1  \n <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/1030051\" target=\"_blank\">1030051</a>:  1  \n <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/1030052\" target=\"_blank\">1030052</a>:  1  \n <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/1065605\" target=\"_blank\">1065605</a>:  1  \n <a href=\"https://www.ncbi.nlm.nih.gov/clinvar/variation/1098603\" target=\"_blank\">1098603</a>:  1  \n (Other)                                                                                     :138  \n GeneSymbol   Type         consequence                   ClinicalSignificance\n FOXP1:144   SNV:144   3-UTR     : 1   Benign                      : 8       \n                       Intronic  :21   Benign/Likely benign        : 5       \n                       Missense  :71   Likely benign               :31       \n                       Splice-D/A:13   Likely pathogenic           :20       \n                       Stop gain :17   Pathogenic                  :33       \n                       Synonymous:21   Pathogenic/Likely pathogenic: 2       \n                                       Uncertain/conflicting       :45       \n                                                  review   \n Criteria provided/ conflicting interpretations      :  6  \n Criteria provided/ multiple submitters/ no conflicts: 16  \n Criteria provided/ single submitter                 :113  \n No assertion criteria provided                      :  9  \n                                                           \n                                                           \n                                                           \n                                                                                        PhenotypeList\n Not provided/ not specified                                                                   :68   \n Mental retardation with language impairment and with or without autistic features             :28   \n History of neurodevelopmental disorder                                                        :10   \n Intellectual disability                                                                       : 6   \n Inborn genetic diseases                                                                       : 5   \n Not provided/ not specified|History of neurodevelopmental disorder|Not provided/ not specified: 5   \n (Other)                                                                                       :22   \n                                            Name         ref_aa       alt_aa  \n NM_001244808.2(FOXP1):c.869+1G>A             :  1   Arg    :16   Ter    :17  \n NM_001244810.1(FOXP1):c.1348+2T>C            :  1   Ala    :14   Thr    :13  \n NM_001349338.3(FOXP1):c.1096A>G (p.Met366Val):  1   Gln    : 9   Ala    : 9  \n NM_001349338.3(FOXP1):c.119A>T (p.Glu40Val)  :  1   Thr    : 9   Ser    : 9  \n NM_001349338.3(FOXP1):c.1313G>A (p.Arg438Gln):  1   Tyr    : 9   Gly    : 7  \n NM_001349338.3(FOXP1):c.1319C>G (p.Ser440Ter):  1   (Other):52   (Other):54  \n (Other)                                      :138   NA's   :35   NA's   :35  \n     pos_aa         CADD_phred  gnomAD_binary_char\n Min.   :  3.0   0.070793:  1   No :83            \n 1st Qu.:192.0   0.204885:  1   Yes:61            \n Median :443.0   0.287364:  1                     \n Mean   :363.8   0.323585:  1                     \n 3rd Qu.:514.0   0.325591:  1                     \n Max.   :674.0   0.352630:  1                     \n NA's   :35      (Other) :138                     \n```\n:::\n\n```{.r .cell-code}\n# removing the first two colummns   \nCVFP1 <- CVFP1[, -c(1, 2)] \n\n# double checking the two columns were removed\nhead(CVFP1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 12\n  GeneSymbol Type  consequence ClinicalSignificance review   PhenotypeList Name \n  <fct>      <fct> <fct>       <fct>                <fct>    <fct>         <fct>\n1 FOXP1      SNV   Stop gain   Pathogenic           Criteri… Mental retar… NM_0…\n2 FOXP1      SNV   Missense    Benign/Likely benign Criteri… Aortic valve… NM_0…\n3 FOXP1      SNV   Intronic    Benign               Criteri… Not provided… NM_0…\n4 FOXP1      SNV   Intronic    Benign               Criteri… Not provided… NM_0…\n5 FOXP1      SNV   Missense    Likely benign        Criteri… Not provided… NM_0…\n6 FOXP1      SNV   Intronic    Benign               Criteri… Not provided… NM_0…\n# ℹ 5 more variables: ref_aa <fct>, alt_aa <fct>, pos_aa <dbl>,\n#   CADD_phred <fct>, gnomAD_binary_char <fct>\n```\n:::\n\n```{.r .cell-code}\n# list of column names \n(column_names <- colnames(CVFP1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"GeneSymbol\"           \"Type\"                 \"consequence\"         \n [4] \"ClinicalSignificance\" \"review\"               \"PhenotypeList\"       \n [7] \"Name\"                 \"ref_aa\"               \"alt_aa\"              \n[10] \"pos_aa\"               \"CADD_phred\"           \"gnomAD_binary_char\"  \n```\n:::\n:::\n\n\n## Static Data Visualizations\n\n### Bar Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(CVFP1, aes(x = ClinicalSignificance)) + geom_bar(color = \"black\", fill = \"lightgray\") + \n  labs(title = \"Clinical Significance of Genetic Variant from FOXP1\", \n       subtitle = \"n = 144\",\n       x = \"Level of Significance\", \n       y = \"Number of Individuals\") + \n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 25, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Interactive Data Visualizations\n\n### Bar Plots\n\n**Note**: As of August 3rd, 2023, I am unable to render using 'plotly'. The code chunk below has came to a halt -- I've troubleshooted by restarting, clearing the console and environment, checking for package conflicts, making sure everything is updated, removed my previous code with `layout()` and am still having this error:\n\n* checked again on August 21st   \n\n\nQuitting from lines 68-138 \\[plotly\\] (index.qmd)\\\nError in `add_html_caption()`:\\\n! unused argument (xfun::grep_sub(\"[^1]\\* \\<\\[\\^\\>\\]+aria-labelledby\\[ \\]\\* =\\[ \\] \\*  \"(\\[\\^ \"\\]+) \".\\*\\$\",\" \\\\1\", x))\\\nBacktrace:\\\n1. global .main()\\\n2. execute(...)\\\n3. rmarkdown::render(...)\\\n4. knitr::knit(knit_input, knit_output, envir = envir, quiet = quiet)\\\n5. knitr:::process_file(text, output)\\\n...\\\n14. sew(res, options)\\\n15. knitr:::sew.list(x, options, ...)\\\n16. base::lapply(x, sew, options, ...)\\\n17. FUN(X\\[\\[i\\]\\], ...)\\\n18. knitr:::sew.knit_asis(x, options, ...)\\\nExecution halted\n\n[^1]: \\^\\<\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clinical Significance Bar Plot\n\n(df.bplot <- CVFP1 %>% dplyr::group_by(ClinicalSignificance) %>% dplyr::count())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 2\n# Groups:   ClinicalSignificance [7]\n  ClinicalSignificance             n\n  <fct>                        <int>\n1 Benign                           8\n2 Benign/Likely benign             5\n3 Likely benign                   31\n4 Likely pathogenic               20\n5 Pathogenic                      33\n6 Pathogenic/Likely pathogenic     2\n7 Uncertain/conflicting           45\n```\n:::\n\n```{.r .cell-code}\ny.cs <- c(8, 5, 31, 20, 33, 2, 45)\n\ntext.clin.sig <- c(\"8\", \"5\", \"31\", \"20\", \"33\", \"2\", \"45\")\n\n## showing the counts of cases based on Clinical Significance \n# b.plot <- plotly::plot_ly(data = df.bplot, \n#                          x = ~ClinicalSignificance, \n#                          y = ~y.cs, \n#                          type = \"bar\", \n#                          text = text.clin.sig, \n#                          marker = list(color = \"maroon\")) \n\n# b.plot\n\n## showing the percentage of case based on Clinical Significance \n\n### Benign  \nben <- paste(round(8/144*100, digits = 2), \"%\", sep = \"\")\n\n### Benign/Likely Benign  \nben.lben <- paste(round(5/144*100, digits = 2), \"%\", sep = \"\")\n\n### Likely Benign  \nlben <- paste(round(31/144*100, digits = 2), \"%\", sep = \"\")\n\n### Likely Pathogenic  \nlpat <- paste(round(20/144*100, digits = 2), \"%\", sep = \"\")\n\n### Pathogenic   \npat <- paste(round(33/144*100, digits = 2), \"%\", sep = \"\")\n\n### Pathogenic/Likely Pathogenic  \npat.lpat <- paste(round(2/144*100, digits = 2), \"%\", sep = \"\")\n\n### Uncertain/Conflicting \nunc.con <- paste(round(45/144*100, digits = 2), \"%\", sep = \"\")\n\n\ntext.per <- c(ben, ben.lben, lben, lpat, pat, pat.lpat, unc.con)\n\n# barplot with percentages \n# b.per.plot <- plotly::plot_ly(data = df.bplot, \n#                          x = ~ClinicalSignificance, \n#                          y = ~y.cs, \n#                          type = \"bar\", \n#                          text = text.per, \n#                          marker = list(color = \"skyblue\")) \n\n# b.per.plot\n\n# Consequence Bar Plot \n\n(df.c.bplot <- CVFP1 %>% dplyr::group_by(consequence) %>% dplyr::count())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n# Groups:   consequence [6]\n  consequence     n\n  <fct>       <int>\n1 3-UTR           1\n2 Intronic       21\n3 Missense       71\n4 Splice-D/A     13\n5 Stop gain      17\n6 Synonymous     21\n```\n:::\n\n```{.r .cell-code}\n# showing the counts \ny.con <- c(1, 21, 71, 13, 17, 21)\n\n# c.b.plot <- plotly::plot_ly(data = df.c.bplot,\n#                          x = ~consequence,\n#                          y = ~y.con, \n#                          type = \"bar\", \n#                          marker = list(color = \"lavender\", \n#                                        line = list(color = \"darkgrey\", \n#                                                    width = 1.5))) \n\n# c.b.plot\n```\n:::\n\n\n## Interactive Plots Using 'highcharter'    \n\n**Note**: As of August 5th, `plotly` is still not running correctly so I'm going to try out this package `highcharter`    \n\nMy ideas and inspiration came from this (site)[https://www.datanovia.com/en/lessons/highchart-interactive-bar-plot-in-r/]    \n\n* August 21st: same code warning with \"highcharter\" as it is with \"plotly\" - I figure at this point it's good to show my flops as well as my successes, so enjoy this little flop   \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"highcharter\")   \nlibrary(highcharter) \n\n# setting highcharter options \noptions(highcharter.theme = hc_theme_smpl(tooltip = list(valueDecimals = 2)))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# basic <- df.c.bplot %>% \n#  highcharter::hchart(\"column\", \n#         hcaes(\n#           x = consequence, \n#           y = y.con\n#         ), \n#         color = \"lavender\", \n#         borderColor = \"black\", \n#         pointWidth = 90)\n# basic\n```\n:::\n\n\n## Interactive Plots Using `gganimate`    \n\nMy ideas and inspiration came from this (site)[https://towardsdatascience.com/create-animated-bar-charts-using-r-31d09e5841da] \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"gganimate\")  \nlibrary(gganimate)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncvfp1_formatted <- CVFP1 %>%\n  group_by(consequence) %>%\n  # The * 1 makes it possible to have non-integer ranks while sliding\n  mutate(C.S.Pathogenic = (ClinicalSignificance==\"Pathogenic\")) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstaticplot <- ggplot(CVFP1, aes(x = ClinicalSignificance)) + geom_bar(color = \"black\", fill = \"lightgray\") + \n  labs(title = \"Clinical Significance of Genetic Variant from FOXP1\", \n       subtitle = \"n = 144\",\n       x = \"Level of Significance\", \n       y = \"Number of Individuals\") + \n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 25, hjust = 1))\n```\n:::\n\n\n### Coding a Plot.gif   \n\n\n::: {.cell}\n\n```{.r .cell-code}\naniplot <- staticplot + \n  transition_states(ClinicalSignificance)\n\n### Note to self: \n\n# do not print/view 'aniplot' at this stage\n    # every static plot gets its own .png file (101 pngs here)\n\n# install.packages(\"gifski\")\nlibrary(gifski)\n\nanimate(aniplot, 200, fps = 20, width = 1200, height = 1000, \n        renderer = gifski_renderer(\"gganim.gif\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/animation-1.gif)\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}